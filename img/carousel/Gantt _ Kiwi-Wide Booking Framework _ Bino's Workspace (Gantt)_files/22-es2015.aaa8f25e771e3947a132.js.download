(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{L4WU:function(e,i,t){"use strict";t.r(i),t.d(i,"ExistingFieldsModalComponent",function(){return z});var d=t("IlGD"),o=t("jJQC"),l=t("3yLq"),n=t("HHlo"),c=t("2eDp"),a=t("LRne"),s=t("2Vo4"),r=t("XNiG"),m=t("itXk"),f=t("pLZG"),u=t("lJxs"),g=t("YwDF"),_=t("+2Ly"),h=t("fXoL"),x=t("SkDE"),p=t("Jf2N"),b=t("l7P3"),v=t("tjnY"),y=t("ofXK"),w=t("UdVN"),k=t("wBsc"),I=t("BTFG");function F(e,i){if(1&e){const e=h.dc();h.cc(0,"div",20),h.Xb(1,"div",21),h.cc(2,"div",22),h.gc(3,23),h.bc(),h.cc(4,"div",24),h.gc(5,25),h.bc(),h.cc(6,"div",26),h.cc(7,"button",27),h.qc("click",function(){return h.Uc(e),h.uc(4).closeModal()}),h.gc(8,28),h.bc(),h.cc(9,"button",29),h.qc("click",function(){h.Uc(e);const i=h.uc().$implicit,t=h.Rc(2);return h.uc(3).attachFieldToEntity(i,t,!0)}),h.gc(10,30),h.bc(),h.bc(),h.bc()}}function C(e,i){if(1&e){const e=h.dc();h.cc(0,"div",31),h.qc("click",function(){h.Uc(e);const i=h.uc().$implicit;return h.uc(3).editField(i)}),h.ac(1),h.gc(2,32),h.Zb(),h.Xb(3,"div",33),h.bc()}}const $=function(e){return{"cu-existing-fields-modal__row-length_expanded":e}};function A(e,i){if(1&e){const e=h.dc();h.cc(0,"div",34),h.qc("click",function(){h.Uc(e);const i=h.uc().$implicit;return h.uc(3).toggleFieldExpanded(i)}),h.gc(1,35),h.bc()}if(2&e){const e=h.uc().$implicit,i=h.uc(3);h.Dc("ngClass",h.Hc(2,$,i.fieldExpandedMap[e.id])),h.Ib(1),h.kc(e.entities.length),h.hc(1)}}function E(e,i){if(1&e&&(h.cc(0,"div",36),h.Xb(1,"cu-custom-fields-usages",37),h.bc()),2&e){const e=h.uc().$implicit;h.Ib(1),h.Dc("entities",e.entities)("fieldId",e.id)}}function T(e,i){if(1&e){const e=h.dc();h.cc(0,"div"),h.bd(1,F,11,0,"ng-template",null,10,h.cd),h.cc(3,"div",11),h.cc(4,"div",12),h.cc(5,"div",13),h.dd(6),h.bc(),h.cc(7,"div",14),h.qc("click",function(){h.Uc(e);const t=i.$implicit,d=h.Rc(2);return h.uc(3).attachFieldToEntity(t,d)}),h.gc(8,15),h.bc(),h.Xb(9,"div",16),h.bd(10,C,4,0,"div",17),h.bc(),h.bd(11,A,2,4,"div",18),h.bc(),h.bd(12,E,2,2,"div",19),h.bc()}if(2&e){const e=i.$implicit,t=h.uc(3);h.Ib(6),h.fd(" ",e.name," "),h.Ib(4),h.Dc("ngIf",t.dontReturnAll),h.Ib(1),h.Dc("ngIf",t.dontReturnAll),h.Ib(1),h.Dc("ngIf",t.dontReturnAll&&t.fieldExpandedMap[e.id])}}function O(e,i){1&e&&(h.cc(0,"div",38),h.gc(1,39),h.bc())}function j(e,i){if(1&e&&(h.ac(0),h.bd(1,T,13,4,"div",8),h.bd(2,O,2,0,"div",9),h.Zb()),2&e){const e=h.uc().$implicit,i=h.uc();h.Ib(1),h.Dc("ngForOf",e.displayFields)("ngForTrackBy",i.trackById),h.Ib(1),h.Dc("ngIf",i.dontReturnAll&&0===e.displayFields.length)}}function D(e,i){if(1&e){const e=h.dc();h.cc(0,"div",3),h.cc(1,"div",4),h.qc("click",function(){h.Uc(e);const t=i.$implicit;return h.uc().toggleTypeExpanded(t)}),h.Xb(2,"div",5),h.cc(3,"div",6),h.dd(4),h.bc(),h.cc(5,"div",7),h.dd(6),h.bc(),h.bc(),h.bd(7,j,3,3,"ng-container",2),h.bc()}if(2&e){const e=i.$implicit,t=h.uc();h.Ib(1),h.Ob("cu-existing-fields-modal__item-header_expanded",t.typeExpandedMap[e.id]),h.Ib(1),h.Dc("icon","field-"+e.typeConfig.type),h.Ib(2),h.fd(" ",e.typeConfig.label," "),h.Ib(2),h.fd(" (",e.displayFields.length,") "),h.Ib(1),h.Dc("ngIf",t.typeExpandedMap[e.id])}}function B(e,i){1&e&&(h.cc(0,"div",42),h.Xb(1,"cu-loader"),h.bc())}function M(e,i){1&e&&(h.cc(0,"div",42),h.gc(1,43),h.bc())}function R(e,i){if(1&e&&(h.ac(0),h.bd(1,B,2,0,"div",40),h.vc(2,"async"),h.bd(3,M,2,0,"ng-template",null,41,h.cd),h.Zb()),2&e){const e=h.Rc(4),i=h.uc();h.Ib(1),h.Dc("ngIf",h.wc(2,2,i.fetchingAvailable$))("ngIfElse",e)}}let z=(()=>{class e{constructor(e,i,t,d){this.customFields=e,this.modalService=i,this.injector=t,this.store=d,this.dontReturnAll=!0,this.addColumn=!1,this.filterForNumericDropdown=!1,this.availableFieldsByType$=Object(a.a)([]),this.searchText$=new s.a(""),this.trackById=Object(o.d)("id"),this.fieldAdded$=new r.a,this.typeExpandedMap={},this.fieldExpandedMap={},this.fetchingAvailable$=this.store.select(c.g)}ngOnDestroy(){this.fieldAdded$.complete()}setEntity(e){this.entity=e,this.store.dispatch(Object(n.j)({entity:e,returnAll:!this.dontReturnAll})),this.availableFieldsByType$=Object(m.a)([this.store.select(c.a).pipe(Object(f.a)(e=>!!e),Object(u.a)(e=>e.filter(i=>this.filterForNumericDropdown?Object(g.d)(i,[]):e)),Object(u.a)(e=>(this.dontReturnAll?d.d:d.a).map(i=>{const t=e.filter(e=>e.type===i.type);return{typeConfig:i,fields:t,displayFields:t,id:i.type}}).filter(e=>e.fields.length>0))),this.searchText$]).pipe(Object(u.a)(([e,i])=>e.map(e=>Object.assign(Object.assign({},e),{displayFields:e.fields.filter(e=>Object(l.a)(e.name,i))}))))}toggleTypeExpanded(e){this.typeExpandedMap[e.id]=!this.typeExpandedMap[e.id]}toggleFieldExpanded(e){this.fieldExpandedMap[e.id]=!this.fieldExpandedMap[e.id]}editField(e){this.modalService.close();const i=this.modalService.openComponent(_.a,this.injector,{title:"&nbsp;",dialogModifier:"cu-modal__dialog-custom-fields",preventExternalClick:!0,bodyModifier:"cu-modal__body_no-min-height"}),t=e&&e.entities?e.entities.find(e=>e.access):null;i.instance.setEntity({id:t.id,type:t.type,name:t.name}),i.instance.fieldIdToEdit=e.id}attachFieldToEntity(e,i,t=!1){if("team"!==this.entity.type||t){const i={fieldId:e.id,name:e.name,type:e.type,typeConfig:e.type_config};this.dontReturnAll?this.customFields.attachFieldToEntity(e.id,this.entity.type,this.entity.id).subscribe(()=>{this.store.dispatch(Object(n.h)({fieldId:e.id,addColumn:this.addColumn,addColumnAfterId:this.addColumnAfterId,addColumnBeforeId:this.addColumnBeforeId})),this.fieldAdded$.next(i),t&&this.modalService.close(),this.modalService.close(),this.store.dispatch(Object(n.m)({entity:this.entity}))}):(this.fieldAdded$.next(i),this.store.dispatch(Object(n.h)({fieldId:e.id,addColumn:this.addColumn,addColumnAfterId:this.addColumnAfterId,addColumnBeforeId:this.addColumnBeforeId})),t&&this.modalService.close(),this.modalService.close())}else this.modalService.open({content:i,modifier:"cu-modal_higher-stack"})}closeModal(){this.modalService.close()}}return e.\u0275fac=function(i){return new(i||e)(h.Wb(x.a),h.Wb(p.a),h.Wb(h.t),h.Wb(b.Store))},e.\u0275cmp=h.Qb({type:e,selectors:[["cu-existing-fields-modal"]],hostAttrs:[1,"cu-existing-fields-modal"],inputs:{dontReturnAll:"dontReturnAll",addColumn:"addColumn",addColumnAfterId:"addColumnAfterId",addColumnBeforeId:"addColumnBeforeId"},decls:5,vars:7,consts:function(){let e,i,t,d,o,l,n,c,a;return e=$localize`:@@common_use-this-field␟a65664b5e4576a4690581b79722343aa26b125aa␟611405296068235848: Use this field `,i=$localize`:@@common_add-cf-to-every-task-everything-view␟61c32c38bb649ad5831996aac34857fc268460eb␟7535052595879167371: Note: This custom field will be added to every task in this Workspace, since you're viewing everything. `,t=$localize`:@@common_add-existing-field-to-task␟07593fb9eb7b2dbf3655f82f33e0d527fe364d12␟8378122372930670956: Are you sure you want to add the field to every task? `,d=$localize`:@@common_cancel␟0e6b8229bd65f93bc8040d0fb598967f220740c7␟5621575282597344349: Cancel `,o=$localize`:@@common_add-to-every-task␟6e1513087128dd1674c34e21c35a2f3d78f7270d␟4105976028775960324: Add to every task `,l=$localize`:@@common_edit␟28f86ffd419b869711aa13f5e5ff54be6d70731c␟7585826646011739428:Edit`,n=$localize`:@@cu-existing-fields-modal__places-count␟989688863da7321df0a1994826be38e18fcdc3a6␟3702022207673545509: ${"\ufffd0\ufffd"}:INTERPOLATION: places `,c=$localize`:@@cu-existing-fields-modal__no-fields-found␟493337666c2a48051cb5f8799dcf7d69286c9341␟1001865232529820374: No fields found `,a=$localize`:@@cu-existing-fields-modal__no-other-fields␟6c11b780f29a1d59611c5a25468b89cb250b67ac␟511286601500250235: There are no other existing fields `,[[1,"cu-existing-fields-modal__search",3,"onChange"],["class","cu-existing-fields-modal__item",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"cu-existing-fields-modal__item"],[1,"cu-existing-fields-modal__item-header",3,"click"],[1,"cu-existing-fields-modal__item-icon",3,"icon"],[1,"cu-existing-fields-modal__item-label"],[1,"cu-existing-fields-modal__item-length"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","cu-existing-fields-modal__no-fields",4,"ngIf"],["createTeamFieldModal",""],[1,"cu-existing-fields-modal__row"],[1,"cu-existing-fields-modal__row-name"],[1,"cu-existing-fields-modal__row-name-text"],[1,"cu-btn","cu-btn_h-23","cu-existing-fields-modal__row-name-use",3,"click"],e,[1,"cu-existing-fields-modal__row-name-divider"],["class","cu-btn cu-btn_h-23 cu-btn_transparent cu-existing-fields-modal__row-name-edit",3,"click",4,"ngIf"],["class","cu-existing-fields-modal__row-length",3,"ngClass","click",4,"ngIf"],["class","cu-existing-fields-modal__row-usages",4,"ngIf"],[1,"cu-conflict-management"],[1,"cu-conflict-management__warning-img"],[1,"cu-conflict-management__warning"],i,[1,"cu-conflict-management__proceed"],t,[1,"move-category__footer"],[1,"cu-btn","cu-conflict-management__cancel",3,"click"],d,[1,"cu-btn",3,"click"],o,[1,"cu-btn","cu-btn_h-23","cu-btn_transparent","cu-existing-fields-modal__row-name-edit",3,"click"],l,["icon","cu2-rename",1,"cu-existing-fields-modal__row-name-edit-icon"],[1,"cu-existing-fields-modal__row-length",3,"ngClass","click"],n,[1,"cu-existing-fields-modal__row-usages"],[3,"entities","fieldId"],[1,"cu-existing-fields-modal__no-fields"],c,["class","cu-existing-fields-modal__no-other",4,"ngIf","ngIfElse"],["noAvailableResults",""],[1,"cu-existing-fields-modal__no-other"],a]},template:function(e,i){if(1&e&&(h.cc(0,"cu-search-input",0),h.qc("onChange",function(e){return i.searchText$.next(e)}),h.bc(),h.bd(1,D,8,6,"div",1),h.vc(2,"async"),h.bd(3,R,5,4,"ng-container",2),h.vc(4,"async")),2&e){let e=null;h.Ib(1),h.Dc("ngForOf",h.wc(2,3,i.availableFieldsByType$))("ngForTrackBy",i.trackById),h.Ib(2),h.Dc("ngIf",0===(null==(e=h.wc(4,5,i.availableFieldsByType$))?null:e.length))}},directives:[v.a,y.p,y.q,w.a,y.o,k.a,I.a],pipes:[y.b],styles:['.cu-existing-fields-modal__search{display:block;margin-bottom:25px}.cu-existing-fields-modal__no-fields,.cu-existing-fields-modal__no-other{font:400 12px/1 Gotham Pro,Proxima Nova,arial,serif;color:#343434;margin-left:50px}.dark-theme .cu-existing-fields-modal__no-fields,.dark-theme .cu-existing-fields-modal__no-other{color:#d5d6d7}.cu-existing-fields-modal__no-fields{margin:15px 0 20px 77px}.cu-existing-fields-modal__item{margin:0 -50px 5px}.cu-existing-fields-modal__item-header{display:flex;align-items:center;padding:10px 50px;cursor:pointer}.cu-existing-fields-modal__item-header:hover{background:#fafbfc}.dark-theme .cu-existing-fields-modal__item-header:hover{background:#2b343b}.cu-existing-fields-modal__item-header:hover .cu-existing-fields-modal__item-icon{fill:#7b68ee}@supports (--theme-main-color:#7b68ee){.cu-existing-fields-modal__item-header:hover .cu-existing-fields-modal__item-icon{fill:var(--theme-main-color)}}.cu-existing-fields-modal__item-header:hover .cu-existing-fields-modal__item-label{color:#7b68ee}@supports (--theme-main-color:#7b68ee){.cu-existing-fields-modal__item-header:hover .cu-existing-fields-modal__item-label{color:var(--theme-main-color)}}.dark-theme .cu-existing-fields-modal__item-header_expanded .cu-existing-fields-modal__item-icon,.dark-theme .cu-existing-fields-modal__item-header_expanded:hover .cu-existing-fields-modal__item-icon{fill:#7b68ee}@supports (--theme-main-color:#7b68ee){.dark-theme .cu-existing-fields-modal__item-header_expanded .cu-existing-fields-modal__item-icon,.dark-theme .cu-existing-fields-modal__item-header_expanded:hover .cu-existing-fields-modal__item-icon{fill:var(--theme-main-color)}}.cu-existing-fields-modal__item-header_expanded .cu-existing-fields-modal__item-label,.cu-existing-fields-modal__item-header_expanded:hover .cu-existing-fields-modal__item-label{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-weight:500;color:#292d34}.dark-theme .cu-existing-fields-modal__item-header_expanded .cu-existing-fields-modal__item-label,.dark-theme .cu-existing-fields-modal__item-header_expanded:hover .cu-existing-fields-modal__item-label{color:#d5d6d7}.cu-existing-fields-modal__item-header_expanded .cu-existing-fields-modal__item-length,.cu-existing-fields-modal__item-header_expanded:hover .cu-existing-fields-modal__item-length{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-weight:500;color:#9b9b9b}.dark-theme .cu-existing-fields-modal__item-header_expanded .cu-existing-fields-modal__item-length,.dark-theme .cu-existing-fields-modal__item-header_expanded:hover .cu-existing-fields-modal__item-length{color:#828588}.cu-existing-fields-modal__item-icon{width:15px;height:15px;display:inline-block;margin-right:12px;fill:#111}.dark-theme .cu-existing-fields-modal__item-icon{fill:#d5d6d7}.cu-existing-fields-modal__item-label{font:400 13px/1 Gotham Pro,Proxima Nova,arial,serif;margin-right:5px;color:#292d34}.dark-theme .cu-existing-fields-modal__item-label{color:#d5d6d7}.cu-existing-fields-modal__item-length{font:400 13px/1 Gotham Pro,Proxima Nova,arial,serif;color:#292d34}.dark-theme .cu-existing-fields-modal__item-length{color:#d5d6d7}.cu-existing-fields-modal__row{display:flex;align-items:center;padding:7px 50px 7px 77px}.cu-existing-fields-modal__row:hover{background:#fafbfc}.dark-theme .cu-existing-fields-modal__row:hover{background:#2b343b}.cu-existing-fields-modal__row:hover .cu-existing-fields-modal__row-name-edit,.cu-existing-fields-modal__row:hover .cu-existing-fields-modal__row-name-use{display:flex}.cu-existing-fields-modal__row-name{display:flex;align-items:center;flex-grow:1;min-width:0}.cu-existing-fields-modal__row-name-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-family:Gotham Pro,Proxima Nova,arial,serif;font-weight:400;font-size:13px;line-height:1;color:#4f495c}@supports (--global-font-support:"Gotham Pro","Proxima Nova",arial,serif){.cu-existing-fields-modal__row-name-text{font-family:var(--global-font-support)}}.dark-theme .cu-existing-fields-modal__row-name-text{color:#abaeb0}.cu-existing-fields-modal__row-name-use{flex-shrink:0;margin-left:7px;display:none}.cu-existing-fields-modal__row-name-divider{flex-grow:1}.cu-existing-fields-modal__row-name-edit{flex-shrink:0;margin-left:7px;display:none}.cu-existing-fields-modal__row-name-edit:hover use{stroke:#fff}.cu-existing-fields-modal__row-name-edit.cu-btn{font-weight:400}.cu-existing-fields-modal__row-name-edit-icon{transition:stroke .2s cubic-bezier(.785,.135,.15,.86) 0s;width:10px;height:11px;margin-left:5px;stroke:#979797}.cu-existing-fields-modal__row-length{color:#7b68ee;transition:color .2s cubic-bezier(.785,.135,.15,.86),background .2s cubic-bezier(.785,.135,.15,.86);font:400 11px/1 Gotham Pro,Proxima Nova,arial,serif;border-radius:4px;padding:6px 5px;position:relative;overflow:hidden;flex-shrink:0;margin-left:10px;width:70px;text-align:center;cursor:pointer}@supports (--theme-main-color:#7b68ee){.cu-existing-fields-modal__row-length{color:var(--theme-main-color)}}.cu-existing-fields-modal__row-length:hover,.cu-existing-fields-modal__row-length_expanded{background:#7b68ee;color:#fff}@supports (--theme-main-color:#7b68ee){.cu-existing-fields-modal__row-length:hover,.cu-existing-fields-modal__row-length_expanded{background:var(--theme-main-color)}}.cu-existing-fields-modal__row-length:before{background:#7b68ee;content:"";display:block;position:absolute;width:100%;height:100%;top:0;left:0;opacity:.2}@supports (--theme-main-color:#7b68ee){.cu-existing-fields-modal__row-length:before{background:var(--theme-main-color)}}.cu-existing-fields-modal__row-usages{background:#fff;box-shadow:0 1px 3px 2px rgba(0,0,0,.08);border-radius:3px;margin:5px 50px 10px 77px;padding-top:5px}.dark-theme .cu-existing-fields-modal__row-usages{background:#2b343b}'],encapsulation:2,changeDetection:0}),e})()}}]);